<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Request Log</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark" />

  <!-- Fonts: Caudex (headings) + Inter (body) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Caudex:wght@600;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      /* Match the updated admin palette (blue/teal) */
      --bg:#0f141a; --card:#111821; --alt:#0c1218; --border:#2a3a49;
      --text:#e7edf4; --muted:#9cb0c3; --bright:#ffffff;
      --primary:#3d7ea6; --primary-hover:#336f93; --ring:rgba(61,126,166,.35);
      --shadow:0 12px 40px rgba(0,0,0,.45);
    }
    *{ box-sizing:border-box }
    html,body{ margin:0; height:100% }
    body{
      background:var(--bg);
      color:var(--text);
      font:16px/1.55 'Inter',system-ui,sans-serif;
      padding:24px;
      overflow-x:hidden;
    }
    .container{ max-width:1200px; margin:0 auto; display:grid; gap:24px }

    /* Header */
    .header{
      display:flex; justify-content:space-between; align-items:center;
      border-bottom:1px solid var(--border); padding-bottom:12px
    }
    h1{ margin:0; font:700 1.8rem 'Caudex',serif; color:var(--bright) }
    .nav a{ color:var(--primary); text-decoration:none; font-weight:700 }
    .nav a:hover{ text-decoration:underline }

    /* Card + table */
    .card{
      background:var(--card); border:1px solid var(--border);
      border-radius:12px; padding:24px; border-top:3px solid var(--primary);
      box-shadow:var(--shadow);
    }
    .muted{ color:var(--muted); font-size:.95rem }

    .table-wrapper{ overflow-x:auto }
    table{
      width:100%; border-collapse:collapse; margin-top:.5rem; table-layout:fixed;
    }
    /* Stable column sizing to avoid layout jump */
    col.col-time{ width:220px }
    col.col-title{ width:240px }
    col.col-ign{ width:220px }
    col.col-coords{ width:160px }
    col.col-user{ width:auto }

    th,td{
      padding:12px 14px; border-bottom:1px solid var(--border);
      text-align:left; vertical-align:middle;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    th{
      color:var(--muted); font:700 .8rem 'Caudex',serif;
      letter-spacing:.03em; text-transform:uppercase
    }
    tbody tr:nth-of-type(odd){ background-color:var(--alt) }
    code{
      background:var(--alt); padding:3px 6px; border-radius:8px; border:1px solid var(--border)
    }

    /* Empty state */
    .empty{ text-align:center; padding:2rem 1rem; color:var(--muted) }

    /* Small helper row for context */
    .subhead{
      display:flex; justify-content:space-between; align-items:center;
      gap:12px; flex-wrap:wrap; color:var(--muted)
    }
    .pill{
      display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px;
      background:rgba(61,126,166,.14); color:var(--text); border:1px solid var(--border);
      font-weight:600; font-size:.85rem;
    }
    .back-link{ display:inline-flex; align-items:center; gap:8px }

    @media (max-width: 768px){
      body{ padding:16px }
      .header{ flex-wrap:wrap; gap:10px }
      table{ table-layout:auto }
      th,td{ white-space:normal }
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1>Request Log</h1>
      <nav class="nav">
        <a class="back-link" href="{{ url_for('dashboard') }}">‚Üê Back to Dashboard</a>
      </nav>
    </header>

    <section class="card">
      <div class="subhead">
        <span class="muted">All title requests submitted via the web form.</span>
        {% if logs %}
          <span class="pill">{{ logs|length }} entr{{ 'y' if logs|length == 1 else 'ies' }}</span>
        {% endif %}
      </div>

      <div class="table-wrapper">
        <table aria-label="Request log table">
          <colgroup>
            <col class="col-time">
            <col class="col-title">
            <col class="col-ign">
            <col class="col-coords">
            <col class="col-user">
          </colgroup>
          <thead>
            <tr>
              <th scope="col">Timestamp (UTC)</th>
              <th scope="col">Title</th>
              <th scope="col">In-Game Name</th>
              <th scope="col">Coordinates</th>
              <th scope="col">Submitted By</th>
            </tr>
          </thead>
          <tbody>
            {% if logs and logs|length %}
              {% for log in logs %}
                <tr>
                  <td>{{ (log.timestamp or '')|e }}</td>
                  <td>{{ (log.title_name or '-')|e }}</td>
                  <td>{{ (log.in_game_name or '-')|e }}</td>
                  <td><code>{{ (log.coordinates or '-')|e }}</code></td>
                  <td>{{ (log.discord_user or 'Web Form')|e }}</td>
                </tr>
              {% endfor %}
            {% else %}
              <tr>
                <td colspan="5" class="empty">No requests have been logged yet.</td>
              </tr>
            {% endif %}
          </tbody>
        </table>
      </div>
    </section>
  </div>
</body>
</html>