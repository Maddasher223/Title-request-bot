<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin â€¢ Notifications</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Caudex:wght@600;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f141a; --card:#111821; --alt:#0c1218; --border:#2a3a49;
      --text:#e7edf4; --muted:#9cb0c3; --bright:#ffffff;
      --primary:#3d7ea6; --primary-hover:#336f93; --ring:rgba(61,126,166,.35);
      --success:#46a490; --danger:#d44a3a; --shadow:0 12px 40px rgba(0,0,0,.45);
    }
    *{ box-sizing:border-box }
    body{ margin:0; background:var(--bg); color:var(--text); font:16px/1.55 'Inter',system-ui,sans-serif; padding:24px }
    .container{ max-width:900px; margin:0 auto; display:grid; gap:24px }
    header.header{ display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid var(--border); padding-bottom:12px }
    h1{ margin:0; font:700 1.8rem 'Caudex',serif; color:var(--bright) }
    .nav a{ color:var(--primary); text-decoration:none; font-weight:700; margin-right:12px }
    .nav a:hover{ text-decoration:underline }

    .flash{
      padding:12px 14px; border-radius:10px; border:1px solid var(--primary);
      background:rgba(61,126,166,.14); color:var(--bright); font-weight:700;
    }
    .flash.success{ border-color:var(--success); background:rgba(70,164,144,.16); color:#e9fbf6 }
    .flash.error{ border-color:var(--danger); background:rgba(212,74,58,.16) }

    .card{ background:var(--card); border:1px solid var(--border); border-radius:12px; padding:24px; border-top:3px solid var(--primary) }
    label{ display:block; font-weight:700; color:var(--muted); margin-bottom:6px }
    input[type="text"], input[type="number"]{
      width:100%; padding:12px; border-radius:10px; border:1px solid var(--border);
      background:var(--alt); color:var(--bright)
    }
    input:focus{ outline:none; border-color:var(--primary); box-shadow:0 0 0 4px var(--ring) }

    .row{ display:grid; grid-template-columns:1fr 1fr; gap:16px }
    @media (max-width: 700px){ .row{ grid-template-columns:1fr } }

    .checkbox{ display:flex; align-items:center; gap:10px }
    .btn{
      display:inline-flex; align-items:center; gap:8px; padding:10px 16px; border-radius:10px;
      background:var(--primary); color:#0a0f14; font-weight:800; border:0; cursor:pointer; font-family:'Caudex',serif;
    }
    .btn:hover{ background:var(--primary-hover) }
    .muted{ color:var(--muted) }

    .pill-wrap{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px }
    .pill{
      padding:4px 10px; border-radius:999px; border:1px solid var(--border);
      background:var(--alt); color:var(--bright); font-weight:700; font-size:.85rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <h1>Notification Settings</h1>
      <nav class="nav" aria-label="Admin navigation">
        <a href="{{ url_for('admin.dashboard') }}">Dashboard</a>
        <a href="{{ url_for('admin.ops') }}">Operations</a>
        <a href="{{ url_for('admin.titles_page') }}">Titles</a>
        <a href="{{ url_for('admin.reservations_page') }}">Reservations</a>
        <a href="{{ url_for('admin.servers_page') }}">Servers</a>
      </nav>
    </header>

    {% for category, message in get_flashed_messages(with_categories=True) %}
      <div class="card" role="alert" aria-live="polite" style="border-top-color:transparent;">
        <div class="flash {{ category }}">{{ message|e }}</div>
      </div>
    {% endfor %}

    <section class="card">
      <form method="POST" action="{{ url_for('admin.notifications') }}" autocomplete="off" novalidate>
        <div class="checkbox">
          <input id="enabled" name="enabled" type="checkbox" value="1" style="width:auto;height:auto"
                 {% if enabled in ['1','true','True','yes','on'] %}checked{% endif %} />
          <label for="enabled" style="margin:0; font-weight:600">Enable reminders</label>
        </div>

        <div class="row" style="margin-top:16px">
          <div>
            <label for="minutes">Lead time (minutes)</label>
            <input id="minutes" name="minutes" type="number" min="1" max="180" value="{{ minutes|e }}" />
            <p class="muted">Default is 15 minutes.</p>
          </div>
          <div>
            <label for="titles_csv">Titles (comma-separated)</label>
            <input id="titles_csv" name="titles_csv" type="text" value="{{ titles|e }}" />
            <p class="muted">e.g. Architect, General, Governor, Prefect</p>
            {% if titles_list %}
              <div class="pill-wrap" aria-label="Currently targeted titles">
                {% for t in titles_list %}
                  <span class="pill">{{ t }}</span>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        </div>

        <div style="margin-top:16px">
          <button type="submit" class="btn">Save Settings</button>
        </div>
      </form>
    </section>
  </div>
</body>
</html>